<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Shooter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/critical.css">
    <link rel="stylesheet" href="./css/responsive.css">
    <link rel="stylesheet" href="./css/leaderboard-simple.css">

    <link rel="icon" href="./assets/space-invaders 64.png" type="image/x-icon">
    <script src="./js/api-service.js" defer></script>
    <script src="./js/auth-ui-simple.js" defer></script>
    <script src="./js/leaderboard-manager.js" defer></script>
    <script src="./script.js" defer></script>

</head>

<body>
    <!-- Simple starfield background -->
    <div class="stars-background">
        <div class="stars"></div>
    </div>

    <!-- Simple nebula background overlay -->
    <div class="nebula-background"></div>

    <span class='game-text'>
        Game will be initialized here
    </span>

    <!-- <div class='game-menu'> -->
    <div class='game-menu'>
        <div class="logo-container">
            <img src="./assets/ui/game_logo.png" alt="Space Shooter" class="game-logo"
                onerror="this.style.display='none'">
            <h1 class='game-title'>SPACE SHOOTER</h1>
        </div>

        <div class="menu-buttons">
            <div class="auth-section" id="auth-section">
                <!-- Show when not logged in -->
                <div class="auth-buttons" id="auth-buttons">
                    <button class='login-btn' data-action="login">
                        <span class="button-icon">üîê</span>
                        <span class="button-text">LOGIN</span>
                    </button>
                    <button class='register-btn' data-action="register">
                        <span class="button-icon">üìù</span>
                        <span class="button-text">REGISTER</span>
                    </button>
                </div>

                <!-- Show when logged in -->
                <div class="user-info-btn hidden" id="user-info-btn">
                    <button class='profile-btn' data-action="profile">
                        <span class="button-icon">üë§</span>
                        <span class="button-text" id="current-username">HALLEYS</span>
                    </button>
                    <button class='logout-btn' data-action="logout">
                        <span class="button-icon">üö™</span>
                        <span class="button-text">LOGOUT</span>
                    </button>
                </div>
            </div>

            <button class='start-game' data-action="start">
                <span class="button-icon">‚ñ∂</span>
                <span class="button-text">START GAME</span>
            </button>
            <button class='settings' data-action="settings">
                <span class="button-icon">‚öô</span>
                <span class="button-text">SETTINGS</span>
            </button>
            <button class='leaderboard' data-action="leaderboard">
                <span class="button-icon">üèÜ</span>
                <span class="button-text">LEADERBOARD</span>
            </button>
            <button class='exit-game' data-action="exit">
                <span class="button-icon">‚úï</span>
                <span class="button-text">EXIT GAME</span>
            </button>
        </div>

        <div class="game-info">
            <p class="version">v1.0.0</p>
        </div>
    </div>

    <!-- Authentication Panels -->
    <!-- Login Panel -->
    <div class="auth-panel login-panel hidden">
        <div class="panel-header">
            <h2 class="panel-title">LOGIN</h2>
            <button class="close-panel" data-panel="login">‚úï</button>
        </div>

        <div class="auth-content">
            <form id="login-form" class="auth-form">
                <div class="form-group">
                    <label for="login-username">Username or Email</label>
                    <input type="text" id="login-username" name="username" required>
                </div>

                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" name="password" required>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">LOGIN</button>
                    <button type="button" class="btn-secondary switch-to-register">
                        Don't have an account? Register
                    </button>
                </div>
            </form>

            <div id="login-message" class="auth-message hidden"></div>
        </div>
    </div>

    <!-- Register Panel -->
    <div class="auth-panel register-panel hidden">
        <div class="panel-header">
            <h2 class="panel-title">REGISTER</h2>
            <button class="close-panel" data-panel="register">‚úï</button>
        </div>

        <div class="auth-content">
            <form id="register-form" class="auth-form">
                <div class="form-group">
                    <label for="register-username">Username</label>
                    <input type="text" id="register-username" name="username" required minlength="3" maxlength="20"
                        pattern="[a-zA-Z0-9_]+">
                    <small>3-20 characters, letters, numbers, and underscores only</small>
                </div>

                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="register-password">Password</label>
                    <input type="password" id="register-password" name="password" required minlength="6">
                    <small>Minimum 6 characters</small>
                </div>

                <div class="form-group">
                    <label for="register-confirm-password">Confirm Password</label>
                    <input type="password" id="register-confirm-password" name="confirmPassword" required>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-primary">REGISTER</button>
                    <button type="button" class="btn-secondary switch-to-login">
                        Already have an account? Login
                    </button>
                </div>
            </form>

            <div id="register-message" class="auth-message hidden"></div>
        </div>
    </div>

    <!-- User Profile Panel -->
    <div class="auth-panel profile-panel hidden">
        <div class="panel-header">
            <h2 class="panel-title">USER PROFILE</h2>
            <button class="close-panel" data-panel="profile">‚úï</button>
        </div>

        <div class="profile-content">
            <div class="user-info">
                <div class="user-avatar">üë§</div>
                <div class="user-details">
                    <h3 id="profile-username">Username</h3>
                    <p id="profile-email">email@example.com</p>
                    <p id="profile-join-date">Joined: Date</p>
                </div>
            </div>

            <div class="user-stats">
                <h4>Your Statistics</h4>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-games">0</div>
                        <div class="stat-label">Games Played</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="best-score">0</div>
                        <div class="stat-label">Best Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-time">0h</div>
                        <div class="stat-label">Time Played</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avg-score">0</div>
                        <div class="stat-label">Average Score</div>
                    </div>
                </div>
            </div>

            <div class="user-scores">
                <h4>Recent Scores</h4>
                <div id="user-scores-list" class="user-scores-list">
                    <div class="no-scores">No scores yet. Play a game to see your scores here!</div>
                </div>
                <button id="view-all-scores" class="btn-small">View All Scores</button>
            </div>

            <div class="profile-actions">
                <button id="logout-btn" class="btn-danger">Logout</button>
                <button class="btn-secondary close-panel" data-panel="profile">Close</button>
            </div>
        </div>
    </div> <!-- Settings Panel -->
    <div class="settings-panel hidden">
        <div class="panel-header">
            <h2 class="panel-title">SETTINGS</h2>
            <button class="close-panel" data-panel="settings">‚úï</button>
        </div>

        <div class="settings-content">
            <div class="setting-group">
                <h3>Audio Settings</h3>
                <div class="setting-item">
                    <label for="master-volume">Master Volume</label>
                    <div class="volume-control">
                        <input type="range" id="master-volume" min="0" max="100" value="50">
                        <span class="volume-value">50%</span>
                    </div>
                </div>

                <div class="setting-item">
                    <label for="music-volume">Music Volume</label>
                    <div class="volume-control">
                        <input type="range" id="music-volume" min="0" max="100" value="30">
                        <span class="volume-value">30%</span>
                    </div>
                </div>

                <div class="setting-item">
                    <label for="sfx-volume">Sound Effects</label>
                    <div class="volume-control">
                        <input type="range" id="sfx-volume" min="0" max="100" value="70">
                        <span class="volume-value">70%</span>
                    </div>
                </div>
            </div>

            <div class="setting-group">
                <h3>Graphics Settings</h3>
                <div class="setting-item">
                    <label for="graphics-quality">Graphics Quality</label>
                    <select id="graphics-quality">
                        <option value="low">Low</option>
                        <option value="medium" selected>Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>

                <div class="setting-item">
                    <label for="show-fps">Show FPS</label>
                    <input type="checkbox" id="show-fps">
                </div>

                <div class="setting-item">
                    <label for="particle-effects">Particle Effects</label>
                    <input type="checkbox" id="particle-effects" checked>
                </div>
            </div>

            <div class="setting-group">
                <h3>Controls</h3>
                <div class="setting-item">
                    <label for="move-up">Move Up</label>
                    <input type="text" id="move-up" value="W" readonly>
                </div>

                <div class="setting-item">
                    <label for="move-down">Move Down</label>
                    <input type="text" id="move-down" value="S" readonly>
                </div>

                <div class="setting-item">
                    <label for="move-left">Move Left</label>
                    <input type="text" id="move-left" value="A" readonly>
                </div>

                <div class="setting-item">
                    <label for="move-right">Move Right</label>
                    <input type="text" id="move-right" value="D" readonly>
                </div>

                <div class="setting-item">
                    <label for="shoot">Shoot</label>
                    <input type="text" id="shoot" value="SPACE" readonly>
                </div>
            </div>
        </div>

        <div class="panel-footer">
            <button class="btn-secondary reset-settings">Reset to Default</button>
            <button class="btn-primary save-settings">Save Settings</button>
        </div>
    </div>

    <!-- Leaderboard Panel -->
    <div class="leaderboard-panel hidden">
        <div class="panel-header">
            <h2 class="panel-title">LEADERBOARD</h2>
            <button class="close-panel" data-panel="leaderboard">‚úï</button>
        </div>

        <div class="leaderboard-content">
            <div class="leaderboard-tabs">
                <button class="tab-button active" data-tab="all-time">All Time</button>
                <button class="tab-button" data-tab="today">Today</button>
                <button class="tab-button" data-tab="this-week">This Week</button>
            </div>

            <div class="difficulty-selector">
                <label for="difficulty-filter">Difficulty:</label>
                <select id="difficulty-filter">
                    <option value="Normal">Normal</option>
                    <option value="Hard">Hard</option>
                    <option value="Expert">Expert</option>
                </select>
            </div>

            <div class="refresh-leaderboard">
                üîÑ Refresh Leaderboard
            </div>

            <div class="leaderboard-list">
                <div class="leaderboard-entries" id="leaderboard-entries">
                    <!-- Loading state -->
                    <div class="loading-state">
                        <div class="loading-spinner"></div>
                        <p>Loading leaderboard...</p>
                    </div>
                </div>
                <div class="pagination-controls" id="pagination-controls">
                    <!-- Pagination buttons will be added here by JavaScript -->
                </div>
            </div>

            <div class="leaderboard-stats">
                <h3>Leaderboard Statistics</h3>
                <div class="stats-grid" id="leaderboard-stats-content">
                    <div class="stat-item">
                        <span class="stat-value" id="total-players">-</span>
                        <span class="stat-label">Total Players</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="highest-score">-</span>
                        <span class="stat-label">Highest Score</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="average-score">-</span>
                        <span class="stat-label">Average Score</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="average-accuracy">-%</span>
                        <span class="stat-label">Avg. Accuracy</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel-footer">
            <button class="btn-primary back-to-menu" data-panel="leaderboard">Back to Menu</button>
        </div>
    </div>

    <!-- Help Panel -->
    <div class="help-panel hidden">
        <div class="panel-header">
            <h2 class="panel-title">CONTROLS & HELP</h2>
            <button class="close-panel" data-panel="help">‚úï</button>
        </div>

        <div class="help-content">
            <div class="help-section">
                <h3>Movement Controls</h3>
                <div class="control-item">
                    <span class="key-icon">W</span>
                    <span class="control-desc">Move Up</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">S</span>
                    <span class="control-desc">Move Down</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">A</span>
                    <span class="control-desc">Move Left</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">D</span>
                    <span class="control-desc">Move Right</span>
                </div>
            </div>

            <div class="help-section">
                <h3>Combat Controls</h3>
                <div class="control-item">
                    <span class="key-icon">SPACE</span>
                    <span class="control-desc">Shoot</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">MOUSE</span>
                    <span class="control-desc">Aim / Rotate Ship</span>
                </div>
            </div>

            <div class="help-section">
                <h3>Game Controls</h3>
                <div class="control-item">
                    <span class="key-icon">ESC</span>
                    <span class="control-desc">Pause Game</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">F1</span>
                    <span class="control-desc">Open Settings</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">H</span>
                    <span class="control-desc">Show/Hide Help</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">P</span>
                    <span class="control-desc">Cycle Performance Level</span>
                </div>
            </div>

            <div class="help-section">
                <h3>Debug Controls (Testing)</h3>
                <div class="control-item">
                    <span class="key-icon">G</span>
                    <span class="control-desc">Heal Player (+10 HP)</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">Z</span>
                    <span class="control-desc">Add Score (+1000)</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">N</span>
                    <span class="control-desc">Force Next Stage</span>
                </div>
                <div class="control-item">
                    <span class="key-icon">B/V/C</span>
                    <span class="control-desc">Create Explosions</span>
                </div>
            </div>
        </div>

        <div class="panel-footer">
            <button class="btn-primary back-to-game" data-panel="help">Back to Game</button>
        </div>
    </div>

    <!-- Help Hint (Bottom Right) -->
    <div class="help-hint">
        <span class="help-text">Press <kbd>H</kbd> for help</span>
    </div>

    <canvas class='game-canvas hidden-canvas' id='gameCanvas'></canvas>
    <!-- <canvas class='game-canvas ' id='gameCanvas'></canvas> -->

</body>
<link rel="stylesheet" href="./css/backgrounds.css">
<link rel="stylesheet" href="./css/panels.css">
<script src="./particles.js" defer></script>
<script src="./object-pool.js" defer></script>
<script src="./performance.js" defer></script>
<script src="./audio-manager.js" defer></script>
<script src="./healthbar.js" defer></script>
<script src="./blast.js" defer></script>
<script src="./collision.js" defer></script>
<script src="./bullet.js" defer></script>
<script src="./starfield.js" defer></script>
<script src="./enemy.js" defer></script>
<script src="./stage.js" defer></script>
<script src="./player.js" defer></script>
<script src="./canvas.js" defer></script>

</html>